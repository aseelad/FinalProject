New Mexico Supreme Court rules to allow same-sex marriage ...A box of cupcakes are seen topped with icons of same-sex couples at City Hall in San Francisco, June 29, 2013.

The ruling makes New Mexico the 17th U.S. state to legalize gay and lesbian marriage, and comes after the governors of Hawaii and Illinois signed bills last month to permit same-sex weddings in their states.

"Denying same-gender couples the right to marry and thus depriving them and their families of the rights, protections and responsibilities of civil marriage violates the equality demanded by the equal protection clause of the New Mexico Constitution," Justice Edward Chavez wrote in a 31-page opinion.

The ruling found that civil marriage should be "construed to mean the voluntary union of two persons to the exclusion of all others" and that "all rights, protections and responsibilities that result from marital relationship shall apply equally."

The decision highlights the shifting legal and social landscape on gay marriage in the United States. Polls have shown increasing public support, and civil rights groups have prevailed at a number of courthouses and with an increasing number of state legislatures. Ten years ago, no U.S. states permitted gay marriage.

Stepping into an intensifying and often bitter national debate over same-sex matrimony, the New Mexico Supreme Court agreed in September to settle the matter for the state after some counties began issuing marriage licenses to gay and lesbian couples, either unilaterally or in response to lower-court rulings.

In a previous ruling, a New Mexico judge upheld the right to gay marriage in a case that applied to counties encompassing the state's largest city, Albuquerque, and the state capital of Santa Fe.

Later, judges in a number of other counties asked clerks to justify their practice of not issuing same-sex marriage licenses. Many clerks began issuing such licenses to same-sex couples rather than go back to court.

One of New Mexico's most vocal opponents of same-sex marriage, Republican state Senator Bill Sharer, responded to the ruling by saying he planned to introduce a constitutional amendment to ban gay marriage. Such an amendment, if passed by the legislature, would ultimately need approval of voters.

"The Supreme Court decided to overturn a several-millennial-long standing law, and I don't think they had any good reason to do it," Sharer said.

Brian Brown, president of the anti-gay marriage group the National Organization for Marriage, called the ruling "a continuation of a very dangerous rush" toward silencing those who see marriage as the union of one man and one woman.

In celebratory tweets, supporters of gay marriage planned Thursday night rallies in several cities. Among those welcoming the ruling was graphic designer Alex Hanna, 43, who along with his partner of 14 years, Yon Hudson, was a plaintiff in a separate legal case seeking a marriage license in Santa Fe.

"We haven't announced our wedding because we wanted it to be legal in the whole state. That was our goal," Hanna said.

Before the ruling, New Mexico faced a situation unique in the United States because its law was ambiguous on same-sex marriage, unlike other states that expressly prohibited or permitted it via constitutional amendments or state law.

The debate reached a crescendo when all 33 county clerks in the state joined the American Civil Liberties Union and the National Center for Lesbian Rights in petitioning New Mexico's high court to decide the issue on a statewide basis.

Eight New Mexico counties were processing marriage applications by same-sex couples ahead of the ruling, said ACLU of New Mexico spokesman Micah McCoy.

"This truly is a historic and joyful day for New Mexico," said Laura Schauer Ives, legal adviser for the ACLU of New Mexico. "The more than 1,000 same-sex couples who have already married in New Mexico can now rest certain knowing their marriages will be recognized and respected by our state."

The ruling goes into effect immediately, said Phil Sisneros, spokesman for state Attorney General Gary King, a Democrat, and lawyers from the plaintiffs' legal team.

"The attorney general is very pleased with the court's ruling and feels that it's something that a great deal of New Mexicans have been waiting for," Sisneros said.