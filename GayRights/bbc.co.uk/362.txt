The Strasbourg judges said the ban broke the Human Rights Convention, which safeguards the right to privacy.

Three ex-servicemen and a former RAF nurse told the court investigations into their homosexuality, and their subsequent sackings, violated their human rights.

Former RAF nurse Jeanette Smith, ex-RAF administrator Graeme Grady, ex-Royal Navy lieutenant-commander Duncan Lustig-Prean and ex-naval rating John Beckett took their case to the European court after it was rejected by the Appeal Court in London.

The government's approach was based on a 1996 report by the Homosexuality Policy Assessment Team.

The judges: "Insofar as the views of personnel outlined in the report could be considered representative, those views were founded solely on the negative attitudes of heterosexual personnel towards those of homosexual orientation."

Mr Grady said: "Now the government has to lift the ban. They cannot maintain it after what the court has said today."

An earlier hearing at the High Court warned the "tide of history" was flowing against the Ministry of Defence (MoD).

About 60 homosexual servicemen are forced to leave the service every year.

The legal action has been backed by civil rights group Liberty and gay rights group Stonewall, which claims a survey shows that public opinion supports a change.

Stonewall's executive director Angela Mason said discrimination was not helping the armed forces, who are desperately short of recruits.

She said: "Lifting the ban will not make our forces one bit less effective.

"There are those, including the MoD, who claim that men and women in the British armed forces are somehow uniquely prejudiced - that they will refuse to serve with lesbians and gay men. I believe that this is an insult."

According to the NOP poll commissioned by the group last week, seven out of 10 Britons believe lesbians and gay men should be allowed to serve in the armed forces.

But the ruling will not lead to an automatic overturning of the ban in the UK.

The government is likely to drag the issue out until 2001 when the Armed Services Bill is due to be reviewed in Parliament.

Meanwhile, a Royal Navy chef who is almost certainly the last man to be sacked from Britain's armed services for being gay said last week that he was considering suing the MoD.

Richard Young, 25, a reservist at HMS Drake, the Devonport naval base in Plymouth, is angry over losing his job and home after admitting to senior officers that he was gay.