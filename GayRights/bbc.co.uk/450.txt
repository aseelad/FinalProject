The Civil Partnerships Bill gives legal rights to same-sex couples who register their partnership at a civil ceremony.

Rights include exemption on inheritance tax, plus social security and pension benefits, as well as property rights.

A Tory amendment saying the rights should be extended to relationships such as long term carers was backed by 148 to 130 in the House of Lords.

Labour peer Lord Alli said: "This amendment is ill-conceived and does nothing other than undermine the purpose of the Bill.

"This is not a Bill to do ill. This is about same sex couples whose relationships are clearly different from siblings. These are complex issues."

The government wanted to give gay couples the right to register their relationship at a civil ceremony.

The plans, announced in last year's Queen's Speech, follow a long campaign for equality for same sex partners.

The term "gay marriage" is not used in the Bill, but the Civil Partnership Registration Scheme seems to have been designed to be as close to a marriage contract as possible.

That has angered some Christian groups, who argue marriage is being undermined, but some gay rights groups say they do not go far enough.

There are also complaints that same-sex couples are now getting rights not available to unmarried heterosexual couples.

Tory Baroness O'Cathain, who opposes the Bill, said it discriminates against families and carers who look after their elderly parents and face hefty tax bills when the relative dies.

She said: "We are told by the government this is not a gay marriage Bill but a Bill about removing injustice.

"Anyone can see that the legal rights are the same as for married couples."

She added: "This Bill sends out a message that family relationships don't matter as much as same sex relationships - that same sex couples are given a higher status than family relationships.

"This is unfair and certain to lead to blatant injustice for family members who have shown commitment and sacrifice."

Former Ulster Unionist MP Lord Maginnis said the Bill was "dealing with couples who want to indulge in a relationship which most likely involves unnatural sexual practices".

But Lib Dem Lord Goodhart said the amendment was a "stalking horse" for opponents to recognising gay partnerships.

For the government, Home Office Minister Baroness Scotland warned that the amendment could have a regressive effect on social security benefits.

"Opening up such a formal legal relationship to family members could lead to questions about the nature of the family unit, blurring the integrity of laws prohibiting sexual relationships within families."

The government says the change makes its proposals unworkable and it intends to try to overturn the amendment.

A government source told BBC News Online: "It's clearly a wrecking amendment to progressive legislation. It's very disappointing the Tories want to scupper it."

Gay lobby group Stonewall says it is "deeply distressed" about the outcome.

The organisation's chief executive, Ben Summerskill, said: "It's a number of years since we have heard peers referring openly to 'unnatural sexual practices' and 'hijacking' of the word gay.

"Sadly, it suggests that making provisions for family carers was not the only motive for attempting to amend the Bill today."

But Tory constitutional affairs spokesman Alan Duncan said a few simple changes would make all the difference.

He accused the government of "throwing their toys out their pram".